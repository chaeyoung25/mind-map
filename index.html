<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ë§ˆì¸ë“œë§µ ìš”ì•½ê¸°</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif; padding: 20px; background-color: #f5f5f5; }
        .container { display: flex; gap: 20px; height: 90vh; flex-direction: column; }
        
        @media (min-width: 768px) {
            .container { flex-direction: row; }
            .input-panel { width: 30%; }
            .map-panel { width: 70%; }
        }

        .input-panel { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: flex; flex-direction: column; }
        .map-panel { background: white; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); position: relative; flex-grow: 1; height: 100%; }
        
        textarea { width: 100%; height: 150px; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; resize: none; box-sizing: border-box;}
        input[type="text"] { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box;}
        button { padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin-bottom: 5px;}
        button:hover { background-color: #0056b3; }
        
        #mynetwork { width: 100%; height: 100%; min-height: 400px; }
        
        .controls { position: absolute; top: 10px; right: 10px; z-index: 10; background: rgba(255,255,255,0.8); padding: 5px; border-radius: 5px; }
        .btn-small { padding: 5px 10px; font-size: 12px; background-color: #6c757d; }
    </style>
</head>
<body>

    <div class="container">
        <div class="input-panel">
            <h2>ğŸ“ ë‚´ìš© ì…ë ¥</h2>
            <p>ë°›ì•„ì“°ê¸° í…ìŠ¤íŠ¸:</p>
            <textarea id="inputText" placeholder="ì—¬ê¸°ì— í…ìŠ¤íŠ¸ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”..."></textarea>
            
            <p>í•µì‹¬ í‚¤ì›Œë“œ (ì‰¼í‘œ êµ¬ë¶„):</p>
            <input type="text" id="keywords" placeholder="ì˜ˆ: ì˜ˆìˆ˜ë‹˜, ì‚¬ë‘, êµ¬ì›">
            
            <button onclick="processData()">ë§ˆì¸ë“œë§µ ìƒì„±í•˜ê¸°</button>
            <hr>
            <p style="font-size:12px; color:#666;">* ì‚¬ìš©ë²•: ë“œë˜ê·¸ë¡œ ì´ë™, í´ë¦­ í›„ í¸ì§‘</p>
        </div>

        <div class="map-panel">
            <div class="controls">
                <button class="btn-small" onclick="setLayout('UD')">íŠ¸ë¦¬í˜•</button>
                <button class="btn-small" onclick="setLayout('Free')">ë°©ì‚¬í˜•</button>
            </div>
            <div id="mynetwork"></div>
        </div>
    </div>

    <script>
        let network = null;

        // íŒŒì´ì¬ì´ í•˜ë˜ ì¼ì„ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ì§ì ‘ í•©ë‹ˆë‹¤!
        function processData() {
            const text = document.getElementById('inputText').value;
            const keywordsRaw = document.getElementById('keywords').value;

            if(!text) { alert("í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!"); return; }

            // 1. í‚¤ì›Œë“œ ì •ë¦¬
            const keywordList = keywordsRaw.split(',').map(k => k.trim()).filter(k => k.length > 0);
            
            // 2. ë°ì´í„° ì¤€ë¹„
            let nodes = [{id: 1, label: 'í•µì‹¬ ìš”ì•½', color: '#FF9800', shape: 'box'}];
            let edges = [];
            let nodeId = 2;

            // 3. ë¬¸ì¥ ë‚˜ëˆ„ê¸°
            const sentences = text.split('.');

            // 4. ì—°ê²° ë¡œì§
            if (keywordList.length === 0) {
                nodes.push({id: 999, label: 'í‚¤ì›Œë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!', color: '#ccc'});
                edges.push({from: 1, to: 999});
            } else {
                keywordList.forEach(kw => {
                    // í‚¤ì›Œë“œ ë…¸ë“œ
                    const kwId = nodeId++;
                    nodes.push({id: kwId, label: kw, color: '#4CAF50', shape: 'ellipse'});
                    edges.push({from: 1, to: kwId});

                    // ë¬¸ì¥ ë§¤ì¹­
                    sentences.forEach(sentence => {
                        if (sentence.includes(kw)) {
                            const cleanSentence = sentence.trim();
                            if (cleanSentence.length > 0) {
                                nodes.push({id: nodeId, label: cleanSentence, color: '#E1F5FE', shape: 'box'});
                                edges.push({from: kwId, to: nodeId});
                                nodeId++;
                            }
                        }
                    });
                });
            }

            drawMap(nodes, edges);
        }

        function drawMap(nodes, edges) {
            const container = document.getElementById('mynetwork');
            const data = {
                nodes: new vis.DataSet(nodes),
                edges: new vis.DataSet(edges)
            };
            
            const options = {
                layout: {
                    hierarchical: {
                        enabled: true,
                        direction: "UD",
                        sortMethod: "directed",
                        levelSeparation: 150
                    }
                },
                physics: false,
                manipulation: { enabled: true }
            };

            network = new vis.Network(container, data, options);
        }

        function setLayout(type) {
            if(!network) return;
            if (type === 'UD') {
                network.setOptions({
                    layout: { hierarchical: { enabled: true, direction: "UD" } },
                    physics: false
                });
            } else {
                network.setOptions({
                    layout: { hierarchical: { enabled: false } },
                    physics: { enabled: true, solver: 'forceAtlas2Based' }
                });
            }
        }
    </script>
</body>
</html>